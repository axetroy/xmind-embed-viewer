{"version":3,"sources":["webpack://XMindEmbedViewer/webpack/universalModuleDefinition","webpack://XMindEmbedViewer/./src/channel-controller.ts","webpack://XMindEmbedViewer/./src/iframe-controller.ts","webpack://XMindEmbedViewer/./src/index.ts","webpack://XMindEmbedViewer/webpack/bootstrap","webpack://XMindEmbedViewer/webpack/startup"],"names":["root","factory","exports","module","define","amd","self","__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","Object","defineProperty","IframeEventChannelController","iFrameController","domain","channel","MessageChannel","eventIndex","handlers","iframe","getIframe","hasAttribute","Error","setAttribute","channelSetupPromise","_this","_a","addEventListener","port1","start","port1Handler","data","preventDefault","removeEventListener","eventDispatcher","bind","undefined","contentWindow","postMessage","port","port2","prototype","type","eventName","payload","forEach","handler","event","callback","includes","index","findIndex","fn","splice","emit","replyEvent","message","IframeController","target","src","element","document","querySelector","HTMLIFrameElement","createElement","appendChild","setStyles","styles","_i","entries","_b","styleKey","style","XMindEmbedViewer","channel_controller_1","iframe_controller_1","args","internalState","sheets","zoomScale","currentSheetId","file","el","origin","location","pathname","replace","iframeController","iframeEventChannelController","load","setZoomScale","setFitMap","switchSheet","sheetId","get","enumerable","configurable","JSON","parse","stringify","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__"],"mappings":"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","file":"xmind-embed-viewer.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"XMindEmbedViewer\"] = factory();\n\telse\n\t\troot[\"XMindEmbedViewer\"] = factory();\n})(self, function() {\nreturn ","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.IframeEventChannelController = void 0;\r\nvar IframeEventChannelController = /** @class */ (function () {\r\n    function IframeEventChannelController(iFrameController, domain) {\r\n        var _this = this;\r\n        if (domain === void 0) { domain = '*'; }\r\n        this.channel = new MessageChannel();\r\n        this.eventIndex = 0;\r\n        this.handlers = {};\r\n        var iframe = iFrameController.getIframe();\r\n        if (iframe.hasAttribute('data-event-channel-setup')) {\r\n            throw new Error('An embed viewer instance already initialized on the iframe!');\r\n        }\r\n        else {\r\n            iframe.setAttribute('data-event-channel-setup', 'true');\r\n        }\r\n        this.channelSetupPromise = (function () { return __awaiter(_this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, new Promise(function (resolve) {\r\n                            iframe.addEventListener('load', function () {\r\n                                var _a;\r\n                                _this.channel.port1.start();\r\n                                var port1Handler = function (e) {\r\n                                    var type = e.data[0];\r\n                                    if (type === 'channel-ready') {\r\n                                        e.preventDefault();\r\n                                        _this.channel.port1.removeEventListener('message', port1Handler);\r\n                                        _this.channel.port1.addEventListener('message', _this.eventDispatcher.bind(_this));\r\n                                        resolve(undefined);\r\n                                    }\r\n                                };\r\n                                _this.channel.port1.addEventListener('message', port1Handler);\r\n                                (_a = iframe.contentWindow) === null || _a === void 0 ? void 0 : _a.postMessage(['setup-channel', { port: _this.channel.port2 }], domain || '*', [_this.channel.port2]);\r\n                            });\r\n                        })];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        }); })();\r\n    }\r\n    IframeEventChannelController.prototype.eventDispatcher = function (e) {\r\n        var _a = e.data || [], type = _a[0], eventName = _a[1], payload = _a[2];\r\n        if (type === 'event' && eventName && this.handlers[eventName]) {\r\n            this.handlers[eventName].forEach(function (handler) { return handler(payload); });\r\n        }\r\n    };\r\n    IframeEventChannelController.prototype.addEventListener = function (event, callback) {\r\n        this.handlers[event] = this.handlers[event] || [];\r\n        if (this.handlers[event].includes(callback))\r\n            return;\r\n        this.handlers[event].push(callback);\r\n    };\r\n    IframeEventChannelController.prototype.removeEventListener = function (event, callback) {\r\n        if (!this.handlers[event])\r\n            return;\r\n        var index = this.handlers[event].findIndex(function (fn) { return fn === callback; });\r\n        this.handlers[event].splice(index, 1);\r\n    };\r\n    IframeEventChannelController.prototype.emit = function (event, payload) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var replyEvent;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.channelSetupPromise];\r\n                    case 1:\r\n                        _a.sent();\r\n                        replyEvent = \"xmind-embed-viewer#\" + this.eventIndex++;\r\n                        return [4 /*yield*/, new Promise(function (resolve) {\r\n                                var handler = function (e) {\r\n                                    var _a = e.data, message = _a[0], payload = _a[1];\r\n                                    if (message === replyEvent) {\r\n                                        _this.channel.port1.removeEventListener('message', handler);\r\n                                        resolve(payload);\r\n                                    }\r\n                                };\r\n                                _this.channel.port1.addEventListener('message', handler);\r\n                                _this.channel.port1.postMessage([event, payload, replyEvent]);\r\n                            })];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return IframeEventChannelController;\r\n}());\r\nexports.IframeEventChannelController = IframeEventChannelController;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.IframeController = void 0;\r\nvar IframeController = /** @class */ (function () {\r\n    function IframeController(target, src) {\r\n        var iframe;\r\n        var element = typeof target === 'string' ? document.querySelector(target) : target;\r\n        if (element === null) {\r\n            throw new Error('IFrame or mount element not found by selector ' + target);\r\n        }\r\n        if (element instanceof HTMLIFrameElement) {\r\n            iframe = element;\r\n        }\r\n        else {\r\n            iframe = document.createElement('iframe');\r\n            element.appendChild(iframe);\r\n        }\r\n        iframe.setAttribute('frameborder', '0');\r\n        iframe.setAttribute('scrolling', 'no');\r\n        iframe.setAttribute('allowfullscreen', 'true');\r\n        iframe.setAttribute('allow', 'allowfullscreen');\r\n        iframe.setAttribute('crossorigin', 'anonymous');\r\n        iframe.setAttribute('src', src);\r\n        this.iframe = iframe;\r\n    }\r\n    IframeController.prototype.getIframe = function () {\r\n        return this.iframe;\r\n    };\r\n    IframeController.prototype.setStyles = function (styles) {\r\n        var iframe = this.getIframe();\r\n        for (var _i = 0, _a = Object.entries(styles); _i < _a.length; _i++) {\r\n            var _b = _a[_i], styleKey = _b[0], value = _b[1];\r\n            // @ts-ignored\r\n            iframe.style[styleKey] = value;\r\n        }\r\n    };\r\n    return IframeController;\r\n}());\r\nexports.IframeController = IframeController;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.XMindEmbedViewer = void 0;\r\nvar channel_controller_1 = require(\"./channel-controller\");\r\nvar iframe_controller_1 = require(\"./iframe-controller\");\r\nvar XMindEmbedViewer = /** @class */ (function () {\r\n    /**\r\n     * Initialize a iframe element from a div/iframe html element.\r\n     */\r\n    function XMindEmbedViewer(args) {\r\n        var _this = this;\r\n        this.internalState = {\r\n            sheets: [],\r\n            zoomScale: 100,\r\n            currentSheetId: ''\r\n        };\r\n        var file = args.file, el = args.el, _a = args.origin, origin = _a === void 0 ? location.origin : _a, _b = args.styles, styles = _b === void 0 ? {\r\n            'height': '350px',\r\n            'width': '750px'\r\n        } : _b;\r\n        var pathname = (\"/\" + location.pathname + \"/embed-viewer\").replace(/\\/{2,}/g, '/');\r\n        var iframeController = new iframe_controller_1.IframeController(el, \"\" + origin + pathname);\r\n        var iframeEventChannelController = new channel_controller_1.IframeEventChannelController(iframeController, origin);\r\n        this.iframeController = iframeController;\r\n        this.iframeEventChannelController = iframeEventChannelController;\r\n        iframeEventChannelController.addEventListener('sheet-switch', function (payload) { return _this.internalState.currentSheetId = payload; });\r\n        iframeEventChannelController.addEventListener('zoom-change', function (payload) { return _this.internalState.zoomScale = payload; });\r\n        iframeEventChannelController.addEventListener('sheets-load', function (payload) { return _this.internalState.sheets = payload; });\r\n        this.iframeController.setStyles(styles);\r\n        if (file) {\r\n            this.load(file);\r\n        }\r\n    }\r\n    /**\r\n     * Add event listener for embed viewer.\r\n     *\r\n     * Available events:\r\n     * - map-ready\r\n     * - zoom-change\r\n     * - sheet-switch\r\n     * - sheets-load\r\n     *\r\n     */\r\n    XMindEmbedViewer.prototype.addEventListener = function (event, callback) {\r\n        this.iframeEventChannelController.addEventListener(event, callback);\r\n    };\r\n    XMindEmbedViewer.prototype.removeEventListener = function (event, callback) {\r\n        this.iframeEventChannelController.removeEventListener(event, callback);\r\n    };\r\n    /**\r\n     * Update styles for created iframe element.\r\n     */\r\n    XMindEmbedViewer.prototype.setStyles = function (styles) {\r\n        this.iframeController.setStyles(styles);\r\n    };\r\n    /**\r\n     * Load a file for embed viewer after iframe ready.\r\n     */\r\n    XMindEmbedViewer.prototype.load = function (file) {\r\n        this.iframeEventChannelController.emit('open-file', file);\r\n    };\r\n    XMindEmbedViewer.prototype.setZoomScale = function (zoomScale) {\r\n        this.iframeEventChannelController.emit('zoom', zoomScale);\r\n    };\r\n    XMindEmbedViewer.prototype.setFitMap = function () {\r\n        this.iframeEventChannelController.emit('fit-map');\r\n    };\r\n    XMindEmbedViewer.prototype.switchSheet = function (sheetId) {\r\n        this.iframeEventChannelController.emit('switch-sheet', sheetId);\r\n    };\r\n    Object.defineProperty(XMindEmbedViewer.prototype, \"zoom\", {\r\n        get: function () {\r\n            return this.internalState.zoomScale;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(XMindEmbedViewer.prototype, \"sheets\", {\r\n        get: function () {\r\n            return JSON.parse(JSON.stringify(this.internalState.sheets));\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(XMindEmbedViewer.prototype, \"currentSheetId\", {\r\n        get: function () {\r\n            return this.internalState.currentSheetId;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return XMindEmbedViewer;\r\n}());\r\nexports.XMindEmbedViewer = XMindEmbedViewer;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(341);\n"],"sourceRoot":""}